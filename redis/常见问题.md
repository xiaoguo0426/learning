### 缓存雪崩

- Redis挂掉，请求全部走数据库
> Redis高可用(主从架构)，尽量避免Redis挂掉的情况发生

- 缓存数据设置的过期时间是相同的，并且Redis恰好将这部分的数据全部删除。这就会导致这段时间内，这些缓存同时失效，全部请求落到数据库中。
> 设置键值有效期的时候加多一个随机值，可以大幅度减少缓存在同一时间过期的情况发生。


![](assets/markdown-img-paste-20190917215802997.png)

### 缓存穿透

- 查询一个一定不存在的数据。由于缓存没有命中，并且处于容错考虑，缓存中查不到数据则不写入缓存，这将导致这个不存在的数据每次请求都要到数据库查询，失去了缓存的意义。
 ![](assets/markdown-img-paste-20190917214835686.png)

解决方案：

1. 请求参数过滤
2. 布隆过滤器 (BloomFilter) 或者压缩 filter 提前拦截
3. 从数据库中查不到数据，也要将空对象设置到缓存中去。有效时间较短
