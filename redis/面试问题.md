### 1.如Redis里面有1亿个key，其中有10w个key是以某个固定的已知的前缀开头的，如果将它们全部找出来？

> 使用keys指令可以扫出指定模式的key列表。

**对方接着追问：如果这个redis正在给线上的业务提供服务，那使用keys指令会有什么问题？**

> 这个时候你要回答redis关键的一个特性：redis的单线程的。`keys`指令会导致线程阻塞一段时间，线上服务会停顿，直到指令执行完毕，服务才能恢复。这个时候可以使用`scan`指令，`scan`指令可以无阻塞的提取出指定模式的key列表，但是会有一定的**重复概率**，在客户端做一次去重就可以了，但是整体所花费的时间会比直接用`keys`指令长。

#### 2.如果有大量的key需要设置同一时间过期，一般需要注意什么？

> 如果大量的key过期时间设置的过于集中，到过期的那个时间点，redis可能会出现短暂的卡顿现象。一般需要在时间上加一个**随机值**，使得过期时间分散一些。

#### 3.Redis如何做持久化的？

> `bgsave`做镜像全量持久化，`aof`做增量持久化。

> 因为`bgsave`会耗费较长时间，不够实时，在停机的时候会导致大量丢失数据，所以需要`aof`来配合使用。

#### 4.Redis的同步机制了解么？

> 第一次同步时，主节点做一次`bgsave`，并同时将后续修改操作记录到内存`buffer`，待完成后将`rdb`文件全量同步到复制节点，复制节点接受完成后将`rdb`镜像加载到内存。加载完成后，再通知主节点将期间修改的操作记录同步到复制节点进行`重放`就完成了同步过程。

#### 5.是否使用过Redis集群，集群的原理是什么？

- `Redis Sentinal`着眼于高可用，在`master`宕机时会自动将`slave`提升为`master`，继续提供服务。
- `Redis Cluster`着眼于扩展性，在单个`redis`内存不足时，使用`Cluster`进行分片存储。
